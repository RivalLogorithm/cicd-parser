os: linux
services: docker
language: python
stages:
  - unittest
  - deploy

jobs:
  include:
    - stage: unittest
      script: python3 -m pytest -v
    - stage: deploy
      script:
        - sh docker login -u $DOCKER_USER -p $DOCKER_PASS
        - sh docker build -f Dockerfile -t $TRAVIS_REPO_SLUG:latest .
        - sh docker push $TRAVIS_REPO_SLUG
  
